
\chapter{Generalities}
\label{cha:generalities}

\section{Scope of the document}
\label{sec:scope-document}

This is a ``working document'' meant to drive the development of the
software library \thelibrary. It is an informal document. All the
people involved in the library development (from now on called the
\emph{authors}) are supposed to freely contribute to its writing.

The major objectives of this document is manifold:
\begin{enumerate}
\item Set up a set of rules regarding program development, coding rules
  and standards, which must be followed by the software developers;
\item Provide the architectural design for the libraries and classes
  to be developed, with a special stress on public interfaces;
\item Provide a subtask subdivision for the work to be done and a
  (possibly accurate) \emph{scheduling}.
\end{enumerate}

\section{Language and nomenclature convection} 
\label{sec:lang-nomencl-conv}

Because of many practical reasons, the document will be written in
English, or at least the best English the authors can manage.

We will use \texttt{typesetting font style} to indicate parts of
actual computer code or name of variables, types, etc..
\textbf{Boldface} is used to mark portion containing rules which
should be followed during program development and \emph{emphasised}
text to indicate important concepts and nomenclature.
 
\section{Software Management} 
\label{sec:software-management}

This software is the result of the work of many people working in a
coordinated fashion, some rules for software management
must be set and agreed upon. A related problem is how to allow for the most ample discussion
between the authors and, at the same time, coordinate  software
production.

To tackle this issue, a web site ala Sourceforge\footnote{\url{http://www.sourceforge.net}} \url{http://iacspc50.epfl.ch} has been set up. It requires that you open an account\footnote{\url{https://iacspc50.epfl.ch/account/register.php}} there and that you declare your intentions to work on \lifev through an email to the development mailing list of \lifev. Once you are part of the project, you have access to all the facilities: tracker, task manager, CVS repository, forums, document manager and a few other tools which are very useful if not absolutely essential to such a project.


\subsection{Version Management}
\label{sec:some-conventions}

The software source, its documentation and all related documents (this
one included) will be kept in a repository under revision control
using CVS\ix{versioning!CVS}\ix{CVS|see{versioning}}\footnote{CVS stands for Concurrent Version System}.  

CVS keywords like \verb!Id! and \verb!Log! should not be included in source files,
they cause many unnecessary conflicts at update/commit time. Use 
\verb!cvs log! to get the information given by \verb!Id! or \verb!Log!.

\section{Compile LifeV}
\label{compile-lifev} 

In order to compile \lifev, certain requirements must be met in terms of compilation tools, and libraries to link to.

\subsection{Requirements}

\subsubsection{Compilation Environment}

\lifev depends on a number of tools at compilation time, they are part of the autotools\ix{autotools} from the GNU project\footnote{\url{http://www.gnu.org}}.

\begin{itemize}
\item \verb!libtool 1.5!\ix{autotools!libtool}\ix{libtool|see{autotools}}
\item \verb!automake 1.7!\ix{autotools!automake}\ix{automake|see{autotools}}
\item \verb!autoconf 2.5x x>=2!\ix{autotools!autoconf}\ix{autoconf|see{autotools}}
\item \verb!g++-3.x x>=2!\ix{compilers!g++}\ix{g++|see{compilers}}
\item \verb!aztec!\ix{algebra!aztec}\ix{aztec!see{algebra}}(which depends on \verb!blas! and \verb!lapack!)
\end{itemize} 

\subsubsection{Runtime Environment}
\label{sec:runtime-env} 

\begin{itemize}
\item \verb!aztec!
\end{itemize} 

\subsection{Compilation from CVS}
\label{sec:compile-cvs} 
You need first to have an account on \url{http://iacspc50.epfl.ch} and be part of the \lifev project, see~\ref{sec:software-management}.

\noindent First, you need to checkout \lifev. \verb!CVS!\ix{CVS} has been configured to use \verb!ssh!\ix{ssh} and your \verb!ssh! keys to access the 
\begin{verbatim}
export CVS_RSH=ssh
cvs -z3 -d:ext:developername@cvs.iacspc50.epfl.ch:/cvsroot/lifev co lifev
\end{verbatim}

\noindent Second, you have to generate the compilation environment by typing:
\begin{verbatim}
make -f Makefile.cvs
\end{verbatim}

\noindent Third, you have to execute the scr1ipt \verb!configure!\ix{autotools|configure}\ix{configure|see{autotools}}, it will automatically check the availability of the needed components for \lifev compilation. You type:
\begin{verbatim}
configure
\end{verbatim}

\noindent Finally, you just have to use \verb!make!\ix{make} to compile \lifev libraries. You type
\begin{verbatim}
make 
\end{verbatim}
Optionally, you use \verb!-j x(x=2,3 or 4)! to speed up the compilation time.

\begin{hint}{Configure}
\verb!configure! is extremely powerful and allows you to maintain several concurrent build directories. Typically during development and testing, you need to have \lifev compiled with debugging flags, optimization flags and/or profiling flags. However combining optimization and debugging flags does not necessarily produce anything useful for debugging and testing purposes.

With configure it is possible to compile a code in a directory which is different from the source directory. This is extremely useful to tacke our problem. Let's consider given the source directory to be store in the environment variable \verb!$LIFEV_HOME$! which is not mandatory.

Here is what you can do to compile with debugging flags:
\begin{verbatim}
cd $LIFEV_HOME;
mkdir debug
CXXFLAGS="-g3 -O0" ../configure
make
\end{verbatim}

Here is what you can do to compile with optimization flags:
\begin{verbatim}
cd $LIFEV_HOME;
mkdir optimized
CXXFLAGS="-O2" ../configure
make
\end{verbatim}

Note that \verb!configure! will fail if you have already compiled \lifev in the source directory.
\end{hint}


\subsection{Compilation from Official Distribution}

The \lifev project provides releases, they are named using the following convention:
\begin{center}
\verb!lifev-x.y.z.tar.gz!
\end{center}

Here is what you have to do:

\begin{enumerate}
\item download \lifev release \verb!lifev-x.y.z.tar.gz!
\item unpack it
\begin{verbatim}
tar xzf lifev-x.y.z.tar.gz
\end{verbatim}
\item configure it
\begin{verbatim}
cd lifev-x.y.z
configure
\end{verbatim}
\item compile it
\begin{verbatim}
make
\end{verbatim}
\end{enumerate}

Some comments in section\ref{sec:compile-cvs} apply also here.


