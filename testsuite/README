# Mode: -*- readme-debian -*-

LifeV Testing Framework
-----------------------

The LifeV testing framework uses AutoTest from autoconf. The latter
is the configuration system of LifeV.

AutoTest uses the same underlying scripting preprocessor m4. It provides
a few marcos that allows to define tests, test groups, data for the tests
and a keyword system to allow running only tests that are tagged with a
particular keyword.

Prerequisites
-------------

* The lifev libraries have been compiled using the autoconf/automake/libtool
  framework. It is not explained here how to compile the libraries.

* Read the section regarding AutoTest in the autoconf manual.

How to run the testsuite
------------------------

* using 'make'

type:

  make check # ensures that all tests are compiled
             # then runs the testsuite

* using the 'testsuite' script

make sure that the 'testsuite' exists, type:

  cd testsuite
  make testsuite # the script is stored in $(srcdir)

then execute the 'testsuite' script, type:

  cd testsuite # in the build directory
  <path to top_srcdir>/testsuite/testsuite # execute the scripts

* run only a group of tests based on keywords

say that you want to run all tests regarding naviar-stokes(ns)

  <path to top_srcdir>/testsuite/testsuite -k ns

Note: some of the keywords were generated using the name of the tests
      for example test_ns_bdf will be executed with both the keywords
      'ns' and 'bdf'

How to create a test for the testsuite
--------------------------------------

There are already a lot of tests in the testsuite, so you
should have a look and copy the behaviour.

Say that you want to create the 'foo' test

 1- create a directory test_foo
 2- create test_foo/Makefile.am
 3- create test_foo/test_foo.cpp # contains the main function
 4- create test_foo/*.{cpp|hpp} that could be needed for the 'foo' test
 5- create test_foo/data if needed # GetPot data file
 6- create test_foo/testsuite.at

    test_foo/testsuite.at should look like this

   AT_SETUP([test_foo])
   AT_DATA([data],[[
   put here the data file for the test
   ]])
   AT_CHECK([\$top_builddir/testsuite/test_foo/test_foo],[0],
            [put here the expected standard output],
            [put here the expected standard error output])
   AT_CLEANUP([put here any files that were created by the test])
 
 7- edit testsuite/testsuite.at to add the new into its proper category
    follow what has been done for the other tests.
 8- make sure to regenerate the 'testsuite' script (see previous section)
 9- run all the tests(see previous section) and go drink a coffee/beer
10- check that everything went fine

 -- Christophe Prud'homme <prudhomm@mit.edu>, Tue Aug 17 17:30:12 2004
