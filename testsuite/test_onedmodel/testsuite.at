# -*- mode: m4 -*-
#
#  This file is part of the LifeV library
#
#  Author(s): Christophe Prud'homme <christophe.prudhomme@epfl.ch>
#       Date: 2004-08-29
#
#  Copyright (C) 2004 EPFL, INRIA and Politechnico di Milano
#
#  This library is free software; you can redistribute it and/or
#  modify it under the terms of the GNU Lesser General Public
#  License as published by the Free Software Foundation; either
#  version 2.1 of the License, or (at your option) any later version.
#
#  This library is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
#  Lesser General Public License for more details.
#
#  You should have received a copy of the GNU Lesser General Public
#  License along with this library; if not, write to the Free Software
#  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# \file testsuite.at
# \author Tiziano Passerini <tiziano@mathcs.emory.edu>
# \date 2004-08-29
# 
AT_SETUP([test_onedmodel (1 tube)])
AT_KEYWORDS([oned onedmodel onetube])

AT_DATA([data],[[
# -*- getpot -*- (GetPot mode activation for emacs)
#-------------------------------------------------
#   Data file for One D Model (Non Linear)
#-------------------------------------------------

[parameters]
use_physical_values = 0
Area0 = 1
# alphaCor	= 1 	# coriolis coeff
# alphaCor	= 1.333333333		# coriolis coeff
beta0	= 1.e6		# pressure law exponent
beta1	= 0.5		# pressure law exponent
Kr	= 2.419026343 	# friction parameter (source term)
# Kr	= 0.		# friction parameter (source term)
R = 2.e4            # terminal resistence

[time]
timebeg	 = 0.0		# inittime
timeend	 = 0.02		# endtime
timestep = 1e-5		# timestep

[initialize]
var = Q
value = 0
firstnode = 51
lastnode = 101
multiplier = 0

[discretization]
x_left	= 0.
x_right	= 10.
nb_elem	= 100	#   number of elements

[miscellaneous]
post_dir = ./                    # the directory for postprocessing files
post_file = sol                  # the file name
verbose = 100
show_graceplot = 0                # 0: no grace plot, 1: show grace plots
postprocess_timestep = 0.01
showCFL = 0
]])
AT_CHECK([$abs_top_builddir/testsuite/test_onedmodel/test_onedmodel],[0],[ignore],[ignore])
AT_CLEANUP([*.m *.mtv])



AT_SETUP([test_onedmodel (linearized)])
AT_KEYWORDS([oned onedmodel linearized viscoelasticity])

AT_DATA([data_lin],[[
# -*- getpot -*- (GetPot mode activation for emacs)
#-------------------------------------------------
#   Data file for One D Model (Non Linear)
#-------------------------------------------------

[parameters]
use_physical_values = 0
Area0 = 3.14159265358979
# alphaCor	= 1 		# coriolis coeff
beta0	= 8.e5		# pressure law exponent
beta1	= 0.5		# pressure law exponent
Kr	= 2.633 		# friction parameter (source term)
rho = 1.05
rho_w = 1.
thickness = 0.15
gamma = 6e4 # canic-armentano estimate for human femoral artery

[time]
timebeg	 = 0.0		# inittime
timeend	 = 1.e-2	# endtime
timestep = 1.e-4	# timestep

[initialize]
var = Q
value = 0
firstnode = 1
lastnode = 2
multiplier = 0
amplitude = 10
# kappa_Re = 0.010180 # for analytical solution C2=C3=0
# kappa_Im = 0
# kappa_Re = 0.010202 # for analytical solution C2=0
# kappa_Im = -6.7744e-04  # for analytical solution C2=0
kappa_Re = 0.009328579668439
kappa_Im = -0.002748137091997
omega = 6.283185307179586 
omega_over_kappa_Re = 6.197558322959819e+02 
omega_over_kappa_Im = 1.825759173688903e+02

[inflow]
signal_amplitude = 1.
signal_rest_value = 0.

[discretization]
x_left	= 0.
x_right	= 1000. # the proposed solution is for 10m long tube 
nb_elem	= 1000	# number of elements

[miscellaneous]
post_dir = ./                    # the directory for postprocessing files
post_file = sol                  # the file name
verbose = 10
postprocess_timestep = 1.e-2
showCFL = 0
viscoelastic_wall = 1
linearize_string_model = 1
linearize_equations = 1
pressure_derivative_steps = 2
]])

AT_CHECK([$abs_top_builddir/testsuite/test_onedmodel/test_linearized],[0],[ignore],[ignore])
AT_CLEANUP([*.m *.mtv])



AT_SETUP([test_onednet])
AT_KEYWORDS([test_onednet onednet])
AT_DATA([datanet],[[
# -*- getpot -*- (GetPot mode activation for emacs)
#-------------------------------------------------
#   Data file for One D Model (Non Linear)
#-------------------------------------------------

[1dnetwork]
num_vessels = 6
num_interfaces = 7
timebeg	 = 0.0
timeend	 = 2e-2
timestep = 1e-5
postprocess_timestep = 0.01
setparam = 1

[./interfacemap]

##############
# first tube #
##############

[1dnetwork/tube1]
left_interface = 1
right_interface = 2

[./parameters]
use_physical_values = 1

[../1d_physics]
young	= 1.e6
thickness = 0.05
radius	= 0.5
density = 1.
viscosity = 0.035
ksi = 0.5

[../initialize]

[../inflow]
signal_amplitude = 1.
signal_rest_value = 0.
# step
step_start_time = .05
step_duration = 0.1
step_smooth_interval = .01
# sin: use defaults
# sin_period = 
# sin_phase =

[../discretization]
x_left	= 0.
x_right	= 10.
nb_elem	= 100

[../miscellaneous]
post_dir = ./
post_file = sol1
verbose = 100
show_graceplot = 0


##############
# second tube #
##############

[1dnetwork/tube2]
left_interface = 2
right_interface = 3

[./parameters]
use_physical_values = 1
R = 2.e4

[../1d_physics]
young	= 1.e6
thickness = 0.05
radius	= 0.5
density = 1.
viscosity = 0.035
ksi = 0.5

[../discretization]
x_left	= 0.
x_right	= 10.
nb_elem	= 100

[../miscellaneous]
post_dir = ./
post_file = sol2
verbose = 100
show_graceplot = 0


##############
# third tube #
##############

[1dnetwork/tube3]
left_interface = 4
right_interface = 2

[./parameters]
use_physical_values = 1

[../1d_physics]
young	= 1.e6
thickness = 0.05
radius	= 0.5
density = 1.
viscosity = 0.035
ksi = 0.5

[../discretization]
x_left	= 0.
x_right	= 10.
nb_elem	= 100

[../miscellaneous]
post_dir = ./
post_file = sol3
verbose = 100
show_graceplot = 0


##############
# fourth tube #
##############

[1dnetwork/tube4]
left_interface = 2
right_interface = 5

[./parameters]
use_physical_values = 1

[../1d_physics]
young	= 1.e6
thickness = 0.05
radius	= 0.5
density = 1.
viscosity = 0.035
ksi = 0.5

[../discretization]
x_left	= 0.
x_right	= 10.
nb_elem	= 100

[../miscellaneous]
post_dir = ./
post_file = sol4
verbose = 100
show_graceplot = 0


##############
# fifth tube #
##############

[1dnetwork/tube5]
left_interface = 6
right_interface = 2

[./parameters]
use_physical_values = 1

[../1d_physics]
young	= 1.e6
thickness = 0.05
radius	= 0.5
density = 1.
viscosity = 0.035
ksi = 0.5

[../discretization]
x_left	= 0.
x_right	= 10.
nb_elem	= 100

[../miscellaneous]
post_dir = ./
post_file = sol5
verbose = 100
show_graceplot = 0


##############
# sixth tube #
##############

[1dnetwork/tube6]
left_interface = 2
right_interface = 7

[./parameters]
use_physical_values = 1

[../1d_physics]
young	= 1.e6
thickness = 0.05
radius	= 0.5
density = 1.
viscosity = 0.035
ksi = 0.5

[../discretization]
x_left	= 0.
x_right	= 10.
nb_elem	= 100

[../miscellaneous]
post_dir = ./
post_file = sol6
verbose = 100
show_graceplot = 0
]])
AT_CHECK([$abs_top_builddir/testsuite/test_onedmodel/test_onednet],[0],[ignore],[ignore])
AT_CLEANUP([*.m *.mtv])
